I believe this is the code I used to make my range-finding bat - although I didn't source control it at the time.
I also believe the zip files are the versions of the libraries I used.